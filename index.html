<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æµ·æˆ°æ£‹ Battleship - GitHub ç‰ˆ</title>
    <style>
        :root {
            --color-sea: #1e3799;
            --color-ship: #4a69bd;
            --color-hit: #eb2f06;
            --color-miss: #78e08f;
            --color-empty: #f1f2f6;
        }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; display: flex; flex-direction: column; align-items: center; background-color: #f0f2f5; margin-top: 50px; }
        h1 { color: #2c3e50; }
        .info { margin-bottom: 20px; text-align: center; }
        /* æ£‹ç›¤ä½ˆå±€ */
        .grid {
            display: grid;
            grid-template-columns: repeat(10, 40px);
            grid-template-rows: repeat(10, 40px);
            gap: 2px;
            background-color: #bdc3c7;
            padding: 5px;
            border-radius: 4px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        /* æ ¼å­æ¨£å¼ */
        .cell {
            width: 40px;
            height: 40px;
            background-color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 12px;
            transition: 0.2s;
        }
        .cell:hover { opacity: 0.8; }
        /* ç‹€æ…‹å°æ‡‰é¡è‰² */
        .status-0 { background-color: white; }        /* ç©ºæµ·åŸŸ */
        .status-1 { background-color: white; }        /* æœ‰èˆ¹(éš±è—æ™‚ç‚ºç™½è‰²) */
        .status-2 { background-color: var(--color-hit); color: white; }  /* æ“Šä¸­ (X) */
        .status-3 { background-color: var(--color-miss); color: white; } /* æ²’ä¸­ (O) */
        
        .debug .status-1 { background-color: #a4b0be; } /* é™¤éŒ¯æ¨¡å¼ä¸‹é¡¯ç¤ºèˆ¹éš» */
        
        .controls { margin-top: 20px; }
        button { padding: 10px 20px; cursor: pointer; background-color: #2ecc71; border: none; color: white; border-radius: 5px; font-weight: bold; }
        button:hover { background-color: #27ae60; }
    </style>
</head>
<body>

    <h1>æµ·æˆ°æ£‹ Battleship</h1>
    
    <div class="info">
        <p id="msg">ç›®æ¨™ï¼šæ‰¾å‡ºä¸¦æ“Šæ²‰æ‰€æœ‰æ•µè‰¦ï¼</p>
        <p>ç‹€æ…‹èªªæ˜ï¼š<span style="color:red">ç´…è‰²(X)</span> = æ“Šä¸­ | <span style="color:green">ç¶ è‰²(O)</span> = æ²’ä¸­</p>
    </div>

    <div id="board" class="grid"></div>

    <div class="controls">
        <button onclick="location.reload()">é‡æ–°é–‹å§‹</button>
    </div>

    <script>
        const SIZE = 10;
        const shipsToPlace = [5, 4, 3, 3, 2]; // å®šç¾©ä¸åŒé•·åº¦çš„èˆ¹
        let boardData = []; // äºŒç¶­é™£åˆ—å„²å­˜ 0, 1, 2, 3
        let totalShipCells = 0;
        let currentHits = 0;

        // åˆå§‹åŒ–æ£‹ç›¤è³‡æ–™
        function initBoard() {
            boardData = Array(SIZE).fill().map(() => Array(SIZE).fill(0));
            shipsToPlace.forEach(len => {
                placeShip(len);
                totalShipCells += len;
            });
            renderBoard();
        }

        // éš¨æ©Ÿæ”¾ç½®èˆ¹éš» (ç‹€æ…‹ 1)
        function placeShip(len) {
            let placed = false;
            while (!placed) {
                let isVertical = Math.random() < 0.5;
                let row = Math.floor(Math.random() * (isVertical ? SIZE - len : SIZE));
                let col = Math.floor(Math.random() * (isVertical ? SIZE : SIZE - len));

                let canPlace = true;
                for (let i = 0; i < len; i++) {
                    if (boardData[isVertical ? row + i : row][isVertical ? col : col + i] !== 0) {
                        canPlace = false;
                        break;
                    }
                }

                if (canPlace) {
                    for (let i = 0; i < len; i++) {
                        boardData[isVertical ? row + i : row][isVertical ? col : col + i] = 1;
                    }
                    placed = true;
                }
            }
        }

        // ç¹ªè£½æ£‹ç›¤åˆ° HTML
        function renderBoard() {
            const boardEl = document.getElementById('board');
            boardEl.innerHTML = '';
            for (let r = 0; r < SIZE; r++) {
                for (let c = 0; c < SIZE; c++) {
                    const cell = document.createElement('div');
                    const state = boardData[r][c];
                    cell.className = `cell status-${state}`;
                    
                    if (state === 2) cell.innerText = 'X';
                    if (state === 3) cell.innerText = 'O';

                    cell.onclick = () => handleAttack(r, c);
                    boardEl.appendChild(cell);
                }
            }
        }

        // è™•ç†æ”»æ“Šé‚è¼¯
        function handleAttack(r, c) {
            const state = boardData[r][c];
            if (state === 2 || state === 3) return; // é‡è¤‡é»æ“Šç„¡æ•ˆ

            if (state === 1) {
                boardData[r][c] = 2; // è®Šæ›´ç‚ºæ“Šä¸­ (2)
                currentHits++;
                document.getElementById('msg').innerText = "ğŸ’¥ æ¼‚äº®ï¼æ“Šä¸­äº†ï¼";
            } else {
                boardData[r][c] = 3; // è®Šæ›´ç‚ºæ²’ä¸­ (3)
                document.getElementById('msg').innerText = "ğŸŒŠ å–”ä¸ï¼Œæ‰“åˆ°æ°´è£¡äº†ã€‚";
            }

            if (currentHits === totalShipCells) {
                document.getElementById('msg').innerText = "ğŸ† è¬æ­²ï¼ä½ æ“Šæ²‰äº†æ‰€æœ‰æ•µè‰¦ï¼";
            }
            renderBoard();
        }

        initBoard();
    </script>
</body>
</html>
